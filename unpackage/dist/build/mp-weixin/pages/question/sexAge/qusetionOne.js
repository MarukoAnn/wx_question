(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/question/sexAge/qusetionOne"],{"1f88":function(t,e,s){"use strict";var i,o=function(){var t=this,e=t.$createElement;t._self._c},a=[];s.d(e,"b",(function(){return o})),s.d(e,"c",(function(){return a})),s.d(e,"a",(function(){return i}))},"3b2c":function(t,e,s){"use strict";var i=s("855e"),o=s.n(i);o.a},"6d11":function(t,e,s){"use strict";s.r(e);var i=s("1f88"),o=s("ac72");for(var a in o)"default"!==a&&function(t){s.d(e,t,(function(){return o[t]}))}(a);s("3b2c");var n,u=s("f0c5"),l=Object(u["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],n);e["default"]=l.exports},"7d9d":function(t,e,s){"use strict";(function(t){s("dc66");i(s("66fd"));var e=i(s("6d11"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,s("543d")["createPage"])},"855e":function(t,e,s){},ac72:function(t,e,s){"use strict";s.r(e);var i=s("e145"),o=s.n(i);for(var a in i)"default"!==a&&function(t){s.d(e,t,(function(){return i[t]}))}(a);e["default"]=o.a},e145:function(t,e,s){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=o(s("c9e6"));function o(t){return t&&t.__esModule?t:{default:t}}var a={data:function(){return{total:null,num:9.6,qestion:"",nowNum:1,nextlabel:"下一题",flag:0,questionjson:"",flagfocus:0,showItem:"",passflag:!1,scrollTop:0,old:{scrollTop:0},isdisStatus:[],title:"",isdisease:0,answer:[],max:0,secondMax:0,thirdMax:0,SumActualTotal:{ph_value:0,qx_value:0,yx_value:0,ya_value:0,ts_value:0,sr_value:0,qy_value:0,tb_value:0,yr_value:0,xk_value:0},SumTotal:[],SumTotalTree:[{label:"ph_value",value:56,name:"平和质"},{label:"qx_value",value:67,name:"气虚质"},{label:"yx_value",value:52,name:"阴虚质"},{label:"ya_value",value:48,name:"阳虚质"},{label:"ts_value",value:51,name:"痰湿质"},{label:"sr_value",value:55,name:"湿热质"},{label:"qy_value",value:23,name:"气郁质"},{label:"tb_value",value:30,name:"特禀质"},{label:"yr_value",value:58,name:"阳热质"},{label:"xk_value",value:23,name:"血亏质"}],SumTotalSex:[{label:"ph_value",value:56,name:"平和质"},{label:"qx_value",value:67,name:"气虚质"},{label:"yx_value",value:52,name:"阴虚质"},{label:"ya_value",value:48,name:"阳虚质"},{label:"ts_value",value:54,name:"痰湿质"},{label:"sr_value",value:55,name:"湿热质"},{label:"qy_value",value:23,name:"气郁质"},{label:"tb_value",value:30,name:"特禀质"},{label:"yr_value",value:58,name:"阳热质"},{label:"xk_value",value:30,name:"血亏质"}],physique_type:[],physique_type_enable:[],physique_result_list:[],physique_answer_list:[],a:!0,user_info:{openid:"",nikename:"",sex:"",tel:""}}},created:function(){"3"===t.getStorageSync("age")?(this.title="3~6岁儿童中医体质调查表",this.questionjson=s("888a"),this.SumTotal=this.SumTotalTree):(this.title="6~14岁儿童中医体质调查表",this.questionjson=s("8801"),this.SumTotal=this.SumTotalSex),this.qestion=this.questionjson.question[this.flag],this.total=this.questionjson.question.length,wx.cloud.init({env:"prod-3pc76",traceUser:!0}),this.islogin()},methods:{selectItemData:function(t){1!==t.status?("false"===this.qestion.more&&this.qestion.select.forEach((function(t){t.color.fontColor="#000",t.color.iconBgc="#000",t.color.itemBgc="#F7F7F7",t.status=0})),t.status=1,t.color.fontColor="#fff",t.color.iconBgc="#fff",t.color.itemBgc="#8ECDFF"):(t.status=0,t.color.fontColor="#000",t.color.iconBgc="#000",t.color.itemBgc="#F7F7F7")},scroll:function(t){this.old.scrollTop=t.detail.scrollTop},setScroll:function(t){this.scrollTop=this.old.scrollTop,this.$nextTick((function(){this.scrollTop=0}))},rebuileComponents:function(){var t=this;this.a=!1,this.$nextTick((function(){t.a=!0}))},nextQuestion:function(e){this.setNextStyle(),""===t.getStorageSync("isCanUse")&&this.wxGetUserInfo()},backQuestion:function(e){0!==this.flag?(this.rebuileComponents(),"提交"===this.nextlabel&&(this.nextlabel="下一题"),this.nowNum=this.nowNum-1,this.flag-=1,this.num=100/this.total*this.nowNum,this.qestion=this.questionjson.question[this.flag]):t.navigateBack()},setQuestionFormat:function(t){var e=this,s=function(s){if(Number(e.SumActualTotal[s])===Number(t)){var i=e.SumTotal.filter((function(t){return t.label===s})),o=[];if(!e.physique_type.some((function(t){return t[0]===i[0].name})))return o.push(i[0].name),o.push(e.SumActualTotal[s]),{v:o}}};for(var i in this.SumActualTotal){var o=s(i);if("object"===typeof o)return o.v}},setNextStyle:function(){var e=this;if("false"===this.qestion.isImage?this.passflag=this.qestion.select.some((function(t){return 1===t.status})):this.passflag=this.qestion.select.every((function(t){return 0!==t.status})),this.flagfocus=0,this.passflag)if("提交"!==this.nextlabel)this.rebuileComponents(),this.setNextQuestionData();else{this.physique_answer_list=[],this.setfitnessSum();var s=function(t){var s=e.SumTotal.filter((function(e){return e.label===t}));e.SumActualTotal[t]=Math.ceil(e.SumActualTotal[t]/(4*s[0].value)*100)};for(var o in this.SumActualTotal)s(o);var a=[];for(var n in this.SumActualTotal)a.push(this.SumActualTotal[n]);this.max=Math.max.apply(null,a),a.splice(a.indexOf(this.max),1),this.secondMax=Math.max.apply(null,a),a.splice(a.indexOf(this.secondMax),1),this.thirdMax=Math.max.apply(null,a);var u=function(t){var s=[];e.SumTotalTree.forEach((function(i){i.label===t&&(s.push(i.name),s.push(e.SumActualTotal[t]))})),e.physique_result_list.push(s)};for(var l in this.SumActualTotal)u(l);this.physique_type.push(this.setQuestionFormat(this.max)),this.physique_type.push(this.setQuestionFormat(this.secondMax)),this.physique_type.push(this.setQuestionFormat(this.thirdMax)),this.physique_type.some((function(t){return"平和质"===t[0]}))&&"平和质"!==this.physique_type[0][0]&&("平和质"===this.physique_type[1][0]?this.physique_type.splice(1,1):this.physique_type.splice(2,1));var c=JSON.parse(t.getStorageSync("user_info")),r=JSON.parse(t.getStorageSync("child"));r.signature=t.getStorageSync("imgBase"),c.tel=r.ptel,0!==t.getStorageSync("isdisease")?r.is_diet=1:JSON.parse(t.getStorageSync("isdisStatus")).includes("是")?r.is_diet=1:r.is_diet=0,t.setStorageSync("physique",JSON.stringify({physique_type:this.physique_type,physique_type_enable:this.physique_type_enable,title:this.title})),t.showLoading({title:"加载中"});var h=this;t.request({url:i.default.env+"/Home/Report/addReport",data:{user_info:c,answer:{physique_type:this.physique_type,physique_answer_list:this.physique_answer_list,physique_result_list:this.physique_result_list,physique_asthma:"0"===t.getStorageSync("isdisease")?0:1,physique_asthma_list:"0"===t.getStorageSync("isdisease")?[]:t.getStorageSync("isdisease").splice(1,2)},child:r},method:"POST",header:{"custom-header":"application/json"},success:function(e){t.hideLoading(),"1000"===e.data.status?(t.setStorageSync("child_id",e.data.data.child_id),t.redirectTo({url:"../../score/physicalScore?value=5"}),h.max=h.thirdMax=h.secondMax=0,h.physique_type=[],t.showToast({title:e.data.msg,duration:2e3})):t.showToast({title:e.data.msg,duration:2e3,icon:"none"})},fail:function(e){t.showToast({title:"请求失败，请检查网络",duration:2e3,icon:"none"})}})}else t.showToast({title:"您有选项未选择",icon:"none",duration:2e3}),this.qestion.select.forEach((function(t){0===t.status&&("false"===e.qestion.isImage?(t.color.fontColor="#fff",t.color.iconBgc="#fff",t.color.itemBgc="#FFA2A2",0===e.flagfocus&&(e.showItem=t.focus,e.flagfocus=1)):(t.error="true",t.color.itemBgc="#FFA2A2",t.color.itemImageBgc="#FFEEEE",0===e.flagfocus&&(e.showItem=t.focus,e.flagfocus=1)))}))},setNextQuestionData:function(){this.flag+=1,this.nowNum=this.nowNum+1,this.nowNum<this.total?this.num=100/this.total*this.nowNum:(this.num=100,this.nextlabel="提交"),this.qestion=this.questionjson.question[this.flag]},selcetChcek:function(t,e){t.color.questionImageSelect.forEach((function(t){t.color.ftcolor="#B3ABAB",t.color.t_iconBgc="#707070",t.color.t_borBgc="#D8D8D8",t.color.bgc="#FCFCFC",t.color.t_innericonBgc="#FFFFFF",t.status=0,t.color.status=0})),t.status=1,t.error="false",t.color.fontColor="#fff",t.color.i_iconBgc="#fff",t.color.itemBgc="#8ECDFF",t.color.itemImageBgc="#E8F5FF",e.color.ftcolor="#FFFFFF",e.color.t_iconBgc="#FFFFFF",e.color.t_borBgc="#5CB7FF",e.color.bgc="#5CB7FF",e.color.t_innericonBgc="#5CB7FF",e.color.status=1},setfitnessSum:function(){var e=this;this.isdisStatus=[],this.questionjson.question[0].select.forEach((function(t){1==t.status&&("A"===t.focus?e.isdisStatus.push("是"):e.isdisStatus.push("否"))})),this.questionjson.question[1].select.forEach((function(t){1==t.status&&("A"===t.focus?e.isdisStatus.push("是"):e.isdisStatus.push("否"))})),t.setStorageSync("isdisStatus",JSON.stringify(this.isdisStatus)),this.questionjson.question.forEach((function(t){if("false"===t.isImage){var s=[];t.select.forEach((function(t,i){if(1===t.status)for(var o in s.push(t.focus),e.SumActualTotal)e.SumActualTotal[o]+=t.value[o]*t.data})),e.physique_answer_list.push(s)}else{var i=[];t.select.forEach((function(t){e.answer.push(t.focus),t.color.questionImageSelect.forEach((function(s){if(1===s.color.status){for(var o in e.answer.push(s.label),e.SumActualTotal)e.SumActualTotal[o]+=t.value[o]*s.color.value;i.push(s.label)}}))})),i.push("flag"),e.physique_answer_list.push(i)}}))},wxGetUserInfo:function(){this.user_info.openid=t.getStorageSync("openid");var e=this;t.getUserInfo({provider:"weixin",success:function(s){console.log(s),e.user_info.nikename=s.userInfo.nickName,e.user_info.sex=s.userInfo.gender,t.setStorageSync("user_info",JSON.stringify(e.user_info)),t.setStorageSync("isCanUse",!1),t.showLoading({title:"加载中"}),e.city=t.getStorageSync("city"),e.getOpenArea(e.user_info.openid)},fail:function(e){console.log(e),t.showToast({title:"网络错误或者拒接授权。",duration:2e3,icon:"none"})}})},islogin:function(){var e=this;t.login({provider:"weixin",success:function(t){console.log(t);t.code;e.getOpenid()}})},getOpenid:function(){wx.cloud.callFunction({name:"getopenid",complete:function(e){t.setStorageSync("openid",e.result.openid)}})},getOpenArea:function(e){var s=this;t.request({url:i.default.env+"/Home/Report/authReport",data:{openid:e,city_name:t.getStorageSync("city")},method:"POST",header:{"custom-header":"application/json"},success:function(e){t.hideLoading(),"1000"===e.data.status?(s.isAuthorize=!1,t.showToast({title:"登录成功,该地区以开放问卷调查。可以进行问卷填写",duration:2e3,icon:"none"}),t.removeStorageSync("area")):(t.showToast({title:e.data.msg,duration:2e3,icon:"none"}),t.redirectTo({url:"../../index/no_questionnaire"}),t.setStorageSync("area","未开放"))},fail:function(e){t.showToast({title:"请求失败，请检查网络",duration:2e3,icon:"none"})}})}}};e.default=a}).call(this,s("543d")["default"])}},[["7d9d","common/runtime","common/vendor"]]]);